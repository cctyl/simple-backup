<!DOCTYPE html>
<html lang="zh">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="favicon.ico">
    <title>sunofbeach_weapp</title>
    <!--    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">-->
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <script src="./js/vconsole.min.js"></script>
    <script>
        // VConsole will be exported to `window.VConsole` by default.
        var vConsole = new window.VConsole();
    </script>
    <script src="./js/vue.js"></script>
    <style>
        ul {
            list-style-type: none;
            padding-left: 0;
        }

        li {
            margin: 8px 0;
        }

        html, body {
            overflow-x: hidden;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        label {
            margin-right: 10px;
        }

        label:hover {
            text-decoration: underline;
            cursor: pointer;
        }

        button {
            font-size: 12px;
            padding: 2px 6px;
        }

    </style>
    <script>

    </script>
</head>
<body>
<div id="app">


    <h2>æ–‡ä»¶åˆ—è¡¨</h2>
    <ul>
        <li>
            <label @click="intoParent" v-if="currentPath && currentPath.length>0">
                è¿”å›ä¸Šä¸€çº§
            </label>
        </li>
        <li v-for="(item, index) in files" :key="index">
            <div style="display: flex; align-items: center;">
                <!-- ç›®å½•å›¾æ ‡ -->
                <span v-if="item.isDirectory" style="margin-right: 10px;">ğŸ“</span>
                <!-- æ–‡ä»¶å›¾æ ‡ -->
                <span v-else style="margin-right: 10px;">ğŸ“„</span>

                <!-- ç‚¹å‡»äº‹ä»¶ç»‘å®š -->
                <label @click="toChild(item)" v-if="item.isDirectory" style="cursor: pointer;">
                    {{ item.name }}
                </label>
                <span v-else>{{ item.name }}</span>

                <!-- æ–‡ä»¶å¤§å° -->
                <span style="margin-left: auto; font-size: 12px; color: gray;">
                    {{ formatSize(item.size) }}
        </span>
            </div>

            <!-- æœ€åä¿®æ”¹æ—¶é—´ -->
            <div style="margin-left: 24px; font-size: 12px; color: #666;">
                æœ€åä¿®æ”¹æ—¶é—´: {{ formatDate(item.lastModified) }}
            </div>
        </li>

    </ul>

</div>

<script>

    window.vue = new Vue({
        el: '#app',
        data() {
            return {
                currentPath:null,

                root:null,
                files: [],

            }
        },
        mounted() {


        },
        computed: {},
        methods: {
            setData(key, value) {
                Vue.set(window.vue.$data, key, value);
            },

            toChild(item) {
                if (!this.currentPath ){
                    this.currentPath = [this.root];
                }else{
                    this.currentPath.push(item);
                }
                Android.intoChild(JSON.stringify(item))
            },
            intoParent() {


                if (this.currentPath && this.currentPath.length > 1) {

                    this.currentPath.pop();
                }

                console.log(this.currentPath)

                if (!this.currentPath || this.currentPath.length <1){
                    console.log("å›åˆ°æ ¹ç›®å½•")
                    Android.intoParent(JSON.stringify(this.root));
                }else if ( this.currentPath.length > 0){
                    let item = this.currentPath[this.currentPath.length-1];
                    item = JSON.stringify(item);

                    console.log("è¿”å›ï¼š"+item)
                    Android.intoParent(item)
                }

            },

            // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚è½¬ KB/MBï¼‰
            formatSize(size) {
                if (size < 1024) return size + ' B';
                else if (size < 1024 * 1024) return (size / 1024).toFixed(1) + ' KB';
                else return (size / (1024 * 1024)).toFixed(1) + ' MB';
            },

            // æ ¼å¼åŒ–æ—¶é—´æˆ³ä¸ºå¯è¯»æ ¼å¼
            formatDate(timestamp) {
                const date = new Date(timestamp);
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            }
        }
    });
</script>
</body>
</html>